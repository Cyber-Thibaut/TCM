<!DOCTYPE html>
<html lang="fr">

<head>
    <!-- Métadonnées du site -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Partenaire de vos déplacements dans Clermont-Ferrand depuis 1989.">
    <meta name="keywords" content="Transport, Clermont-Ferrand, Mobilité">
    <meta name="author" content="Transport Clermont Métropole">
    <title>Transport Clermont Métropole</title>

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="https://tcm-mobilite.vercel.app/img/TCM.png">

    <!-- Intégrations pour réseaux sociaux -->
    <meta property="og:title" content="Transport Clermont Métropole">
    <meta property="og:description" content="Partenaire de vos déplacements dans Clermont-Ferrand depuis 1989.">
    <meta property="og:image" content="https://tcm-mobilite.vercel.app/img/TCM Clair.png">
    <meta property="og:url" content="https://tcm-mobilite.vercel.app/">
    <meta name="twitter:title" content="Transport Clermont Métropole">
    <meta name="twitter:description" content="Partenaire de vos déplacements dans Clermont-Ferrand depuis 1989.">
    <meta name="twitter:image" content="https://tcm-mobilite.vercel.app/img/TCM Clair.png">
    <meta name="twitter:card" content="summary_large_image">

    <!-- Couleur de fond pour l'intégration -->
    <meta name="theme-color" content="#204BFE">

    <link href="../dist/output.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="menu.js"></script>


</head>

<body>
    <br>
    <div>
        <h1 id="pageTitle" class="text-5xl font-bold text-center"></h1>
        <div class="divider"></div>
        <div id="details"></div>
    </div>

    <!-- Conteneur pour afficher les informations -->
    <div id="infos-ligne">

        <!-- Les informations de la ligne seront affichées ici -->
    </div>
    <br>
    <footer class="footer footer-center p-10 bg-primary text-primary-content">
        <aside>
            <img src="\img\TCM.png" width="100" height="100" alt="Logo TCM"
                class="bg-gray-200 bg-opacity-30 p-2 rounded ">
            <p class="font-bold">
                Transport Clermont Métropole <br />Partenaire de vos déplacements depuis 1989.
            </p>
            <p>Copyright © 2023 - Tous droits réservés</p>
        </aside>
    </footer>
    <!-- Script JavaScript pour charger et afficher les données depuis le JSON -->
    <script>
        // Fonction pour charger et afficher les informations de la ligne
        async function chargerInfosLigne(numeroLigne) {
            try {
                const response = await fetch('ligne.json'); // Charge le fichier JSON
                const data = await response.json(); // Convertit la réponse en objet JavaScript

                // Recherche la ligne correspondant au numéro de ligne
                const ligne = data.lignes.find(l => l.id === parseInt(numeroLigne));

                if (ligne) {
                    const ligneContainer = document.createElement('div');
                    ligneContainer.classList.add('container', 'mx-auto', 'flex', 'flex-col', 'items-center', 'justify-center', 'space-y-4', 'py-4');

                    // Créer le conteneur pour l'image et le texte
                    const imageEtTexteContainer = document.createElement('div');
                    imageEtTexteContainer.classList.add('text-5xl', 'font-bold', 'text-center', 'flex', 'flex-row', 'items-center', 'justify-center', 'space-x-4');

                    // Créer l'élément d'image
                    const numeroLigneElement = document.createElement('img');
                    numeroLigneElement.src = "/img/" + ligne.id + ".png";
                    numeroLigneElement.classList.add("w-15", "h-12", "mr-2");
                    imageEtTexteContainer.appendChild(numeroLigneElement);

                    // Créer l'élément de texte
                    const texteLigneElement = document.createElement('p');
                    texteLigneElement.textContent = `${ligne.nom}`;
                    imageEtTexteContainer.appendChild(texteLigneElement);

                    // Ajouter le conteneur imageEtTexteContainer à #pageTitle
                    const pageTitle = document.getElementById('pageTitle');
                    pageTitle.appendChild(imageEtTexteContainer);
                    // Récupérer le lien du plan de la ligne en fonction de l'ID
                    const planUrl = `https://transport-manager.net/assets/img/lignes/N3_L${ligne.id}_blanc2.png`;

                    // Plan de la ligne
                    const planLigne = document.createElement('img');
                    planLigne.src = planUrl;
                    planLigne.alt = `Plan de la ligne ${ligne.id}`;
                    planLigne.classList.add('w-full', 'h-auto'); // Ajoutez des classes de style TailwindCSS pour redimensionner l'image
                    ligneContainer.appendChild(planLigne);

                    const ligneInfoContainer = document.createElement('div');


                    const typeLigne = document.createElement('p');
                    typeLigne.classList.add('text-lg', 'text-secondary');
                    typeLigne.textContent = `Réseau ${ligne.type}`;
                    ligneContainer.appendChild(typeLigne);

                    // Crée une div pour les statistiques de la ligne
                    const statsContainer = document.createElement('div');
                    statsContainer.classList.add('stats', 'stats-vertical', 'lg:stats-horizontal', 'shadow');

                    // Fonction pour ajouter une statistique à la div de statistiques
                    function ajouterStatistique(titre, valeur, description) {
                        const stat = document.createElement('div');
                        stat.classList.add('stat');

                        const statTitre = document.createElement('div');
                        statTitre.classList.add('stat-title');
                        statTitre.textContent = titre;

                        const statValeur = document.createElement('div');
                        statValeur.classList.add('stat-value');
                        statValeur.textContent = valeur;

                        const statDesc = document.createElement('div');
                        statDesc.classList.add('stat-desc');
                        statDesc.textContent = description;

                        stat.appendChild(statTitre);
                        stat.appendChild(statValeur);
                        stat.appendChild(statDesc);

                        statsContainer.appendChild(stat);
                    }

                    // Ajoute les statistiques de la ligne à la div de statistiques
                    ajouterStatistique('Nombre d\'arrêts', ligne.stats.nombre_arrets, '');
                    ajouterStatistique('Temps de trajet', ligne.stats.temps_trajet, '');
                    ajouterStatistique('Longueur de la ligne', ligne.stats.longueur_ligne, '');

                    // Ajoute la div de statistiques au conteneur principal
                    ligneContainer.appendChild(statsContainer);

                    const descriptionLigne = document.createElement('p');
                    descriptionLigne.classList.add('text-lg', 'text-gray-500', 'dark:text-gray-400');
                    descriptionLigne.innerHTML = ligne.description.replace(/\n/g, "<br><br>");
                    ligneContainer.appendChild(descriptionLigne);

                    const espaceVertical = document.createElement('div');
                    espaceVertical.classList.add('my-4'); // Ajoutez la classe d'espace vertical
                    ligneContainer.appendChild(espaceVertical);

                    if (ligne.pdf_url) {
                        const boutonPDF = document.createElement('a');
                        boutonPDF.classList.add(
                            'bg-blue-500',
                            'text-white',
                            'dark:text-gray-800',
                            'rounded-full',
                            'py-2',
                            'px-4',
                            'font-semibold',
                            'hover:bg-blue-600',
                            'flex',
                            'items-center'
                        );
                        boutonPDF.href = ligne.pdf_url;

                        // Créer l'icône SVG en tant qu'image
                        const icon = document.createElement('img');
                        icon.classList.add('w-6', 'h-6', 'dark:text-gray-800', 'text-white');
                        icon.setAttribute('src', 'data:image/svg+xml,' + encodeURIComponent(`
  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 18">
    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 1v11m0 0 4-4m-4 4L4 8m11 4v3a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-3"/>
  </svg>
`));

                        // Texte du bouton
                        const buttonText = document.createTextNode(' Horaires du 2 septembre 2023 au 5 juillet 2024');

                        // Ajouter l'icône et le texte au boutonPDF
                        boutonPDF.appendChild(icon);
                        boutonPDF.appendChild(buttonText);

                        // Vérifiez si l'URL du PDF est vide
                        if (!ligne.pdf_url.trim()) {
                            boutonPDF.classList.add('btn', 'disabled');
                            boutonPDF.removeAttribute('href'); // Supprime le lien si le PDF est vide
                            boutonPDF.setAttribute('disabled', 'disabled');
                        }

                        ligneContainer.appendChild(boutonPDF);

                    }

                    // Ajoute le conteneur de la ligne au conteneur principal
                    document.getElementById('infos-ligne').appendChild(ligneContainer);
                } else {
                    console.error('Ligne non trouvée.');
                }
            } catch (error) {
                console.error('Erreur lors du chargement des données :', error);
            }
        }

        // Obtient le numéro de ligne depuis l'URL
        const url = new URL(window.location.href);
        const numeroLigne = url.hash.substring(1); // Extrait le numéro de ligne de la partie de l'URL après le "#" (par exemple, #1)

        // Appelle la fonction pour charger les informations de la ligne
        chargerInfosLigne(numeroLigne);
    </script>
    <script>
        // Obtenir le fragment de l'URL
        const fragment = window.location.hash.substring(1);

        // Vérifier s'il y a un fragment
        if (fragment) {
            // Construire le nom du script en fonction du fragment
            const scriptName = "/src/scripts/" + fragment + ".js";

            // Créer un élément de script
            const script = document.createElement("script");

            // Spécifier l'attribut "src" pour charger le script correspondant
            script.src = scriptName;

            // Ajouter le script à la page
            document.head.appendChild(script);
        }
    </script>

</body>

</html>